% !TEX root = ./document.tex

\documentclass{article}

\usepackage{mystyle}
\usepackage{myvars}

%-----------------------------

\begin{document}

  \maketitle

  %-----------------------------
  %  TEXT
  %-----------------------------

  \abstract{En este trabajo se realizarán distintas demostraciones relacionadas con la estimación del estadístico \emph{total poblacional} denotado por $\Tau$ sobre una metodología muestral basada en \emph{muestreo estratificado} en el que en cada estrato se extrae una \emph{muestra aleatoria simple (m.a.s.)}.}

  \section{Introducción}

    \paragraph{}
    Denotaremos por $U = U_1 \cup ... \cup U_h \cup... \cup U_L = \{1, ...,k,...,N\} $ a la población, para la cual tenemos una división en $L$ estratos denotando por $U_h$ al estrato $h \in \{1,..., L\}$. Sea $I_h$ el conjunto de índices de las observaciones seleccionadas en el estrato $U_h$ y $s_h$ la muestra extraida de dicho estrato. Por tanto, podemos denotar a la muestra global por $s = s_1 \cup ... \cup s_h \cup ... \cup s_L$

    \paragraph{}
    En este caso, tal y como se ha indicado anteriormente se va a presuponer la utilización del método \emph{m.a.s.} sobre cada estrato, caracterizado porque el tamaño de la muestra se fija \emph{a-priori} y se seleccionan las observaciones \emph{sin reemplazamiento}, es decir, una vez seleccionada una observación, esta desaparece del conjunto de candidatos a aparecer en la muestra. Por tanto, no hay observaciones repetidas en la muestra.

    \paragraph{}
    Denotaremos por $\Tau$ al total poblacional de una determinada variable de interés $Y$ denotando como $y_k \quad \forall k \in U$ al \emph{$k$-ésimo} valor de $Y$. Es fácil entender por tanto que el total poblacional se define como $\Tau = \sum\limits_U y_k$.

    \paragraph{}
    En el caso del \emph{muestreo aleatorio simple (m.a.s.)}, a partir del cual se pretende obtener una aproximación lo más precisa posible del total poblacional $\Tau$, es necesario apoyarse en los valores del tamaño de la población $N$, el del estrato $U_h$ como $N_h$ y el de la muestra $s_h$ denotado por $n_h$. El tamaño relativo del estrato se define como $W_h = \frac{N_h}{N}$. También se define el tamaño relativo de la muestra como $f_h = \frac{n_h}{N_h}$. Entonces, en este caso un buen estimador del total poblacional es el $\pi$-estimador $\widehat{\Tau} = \sum\limits_{s_h} \frac{y_k}{W_h}$.

    \paragraph{}
    La varianza del estimador del total sobre cada estrato se define a continuación:

    \begin{align}
      \begin{split}
        Var(\widehat{\Tau_h}) &= \\
        &=\frac{N_h^2 (1-f_h)\sigma_h^{2*}}{n_h} \\
        &= \frac{N_h^2 (1-\frac{n_h}{N_h})\sigma_h^{2*}}{n_h} \\
        &= \frac{(N_h^2- N_hn_h)\sigma_h^{2*}}{n_h} \\
        &= \left(\frac{N_h^2}{n_h}- N_h\right)\sigma_h^{2*}
      \end{split}
    \end{align}

    \paragraph{}
    En las siguientes secciones se realiza la demostración acerca de los tamaños óptimos para la muestra de cada estrato suponiendo conocido el tamaño $n$ de muestra global (sección \ref{sec:dem_1}) y fijado un presupuesto $C$ (sección \ref{sec:dem_2})


    \section{Tamaño de muestra en cada estrato, conocido el tamaño $n$ de muestra global}
    \label{sec:dem_1}

      \paragraph{}
      El problema se presenta como la obtención del tamaño óptimo $n_h \quad h \in \{1,..., L\}$ que minimice la varianza global (\textbf{afijación de mínima varianza}) de la estimación, suponiendo como valor conocido $N$ para la obtención del mejor estimador de un determinado estadístico. Definiremos la función $\phi(n_1, ..., n_L)$ como:

      \begin{equation}
        \phi(n_1, ..., n_L) = Var(\widehat{\theta}) + \lambda \left( \sum\limits_{h=1}^L n_h - n\right)
      \end{equation}

      \paragraph{}

      Entonces el objetivo es minimizar dicha función, de tal manera que se minimiza la varianza global de la estimación $\widehat{\theta}$. Esto es equivalente a buscar los valores que hagan mínima dicha función, es decir:

      \begin{equation}
        min_{n_h}\{\phi(n_1, ..., n_L)\}
      \end{equation}

      \paragraph{}
      Para obtener dicho mínimo se pueden utilizar distintas técnicas, sin embargo, en este caso basta con la búsqueda del punto que hace nulo el valor de la derivada, tal y como se verá a continuación.

      \begin{equation}
        \phi(n_1, ..., n_L) = Var(\widehat{\theta}) + \lambda \left( \sum\limits_{h=1}^L n_h - n\right)
      \end{equation}


      \paragraph{}
      El primer paso es derivar la función $\phi(n_1, ..., n_L)$ respecto del valor que se pretende minimizar:

      \begin{align}
      \label{eq:derivate_1}
        \begin{split}
          \frac{\partial \phi(n_1, ..., n_L)}{\partial n_h} &= \\
          &= \frac{\partial\left( \left(\frac{N_h^2}{n_h}- N_h\right)\sigma_h^{2*}
          + \lambda \left( \sum\limits_{h=1}^L n_h - n\right)\right) }{\partial n_h} \\
          &= \frac{-N_h^2 \sigma_h^{2*}}{n_h^2} +\lambda \\
          &= 0
        \end{split}
      \end{align}

      \paragraph{}
      Puesto que $n_1 + ... + n_L = n$ se obtiene:

      \begin{align}
        \sqrt{\lambda} &= \frac{\sum\limits_{h=1}^L N_h \sigma_h^{*}}{n}
      \end{align}

      \paragraph{}
      Por último, se despeja el valor $n_h$, es decir, el tamaño de cada estrato:

      \begin{align}
        \begin{split}
          n_h &= \\
          &= \frac{N_h \sigma_h^{*}}{\sqrt{\lambda}}\\
          &= \frac{N_h \sigma_h^{*}}{\frac{\sum\limits_{h=1}^L N_h \sigma_h^{*} }{n}}\\
          &= \frac{n N_h \sigma_h^{*}}{\sum\limits_{h=1}^L N_h \sigma_h^{*} }
        \end{split}
      \end{align}

    \section{Tamaño de muestra en cada estrato, fijado un presupuesto C}
    \label{sec:dem_2}

      \paragraph{}
      También se puede considerear el mismo problema apoyandonos en una función coste en lugar del valor del tamaño poblacional $n$. Para ello, se define el coste como $C = C_0 + \sum\limits_{h=1}^LC_hn_h$ de tal manera que se presupone un coste constante $C_0$ y un coste para cada estrato $C_h$. Suponemos el valor $C$ como conocido y lo denominaremos presupuesto. Entonces ahora la función a minimizar se transforma en:

      \begin{equation}
        \phi(n_1, ..., n_L) = Var(\widehat{\theta}) + \lambda \left( C_0 \sum\limits_{h=1}^LC_hn_h - C\right)
      \end{equation}

      \paragraph{}
      El primer paso es derivar la función $\phi(n_1, ..., n_L)$ respecto del valor que se pretende minimizar:

      \begin{align}
      \label{eq:derivate_2}
        \begin{split}
          \frac{\partial \phi(n_1, ..., n_L)}{\partial n_h} &= \\
          &= \frac{\partial\left( \left(\frac{N_h^2}{n_h}- N_h\right)\sigma_h^{2*}
          + \lambda \left( \sum\limits_{h=1}^L n_h - n\right)\right) }{\partial n_h} \\
          &= \frac{-N_h^2 \sigma_h^{2*}}{n_h^2} +\lambda C_h\\
          &= 0
        \end{split}
      \end{align}

      \paragraph{}
      Subtituyendo $n_h$ en la expresión $C = C_0 + \sum\limits_{h=1}^LC_hn_h$ se obtiene:

      \begin{align}
        \sqrt{\lambda} &= \frac{\sum\limits_{h=1}^L N_h \sigma_h^{*} \sqrt{C_h} }{C - C_0}
      \end{align}

      \paragraph{}
      Por último, se despeja el valor $n_h$, es decir, el tamaño de cada estrato:

      \begin{align}
        \begin{split}
          n_h &= \\
          &= \frac{N_h \sigma_h^{*}}{\sqrt{\lambda}}\\
          &= \frac{N_h \sigma_h^{*}}{\frac{\sum\limits_{h=1}^L N_h \sigma_h^{*} \sqrt{C_h} }{C - C_0}}
        \end{split}
      \end{align}


  %-----------------------------
  %  Bibliographic references
  %-----------------------------

  \nocite{muest2017}
  \nocite{sarndal2003model}

  \bibliographystyle{acm}
  \bibliography{bib}

\end{document}
